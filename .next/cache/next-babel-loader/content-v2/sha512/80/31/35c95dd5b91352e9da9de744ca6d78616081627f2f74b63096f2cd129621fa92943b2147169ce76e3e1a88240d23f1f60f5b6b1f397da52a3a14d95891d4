{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/home/ajay/web/projects/dm-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/ajay/web/projects/dm-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport GoogleSVG from \"./google.svg\";\nimport getConfig from \"next/config\";\nimport { useState } from \"react\";\nimport { testLogin, backendLogin } from \"./firebase.auth\";\nimport firebase from \"config/firebase.config\";\nimport { useAuth } from \"contexts/useAuth\";\n\nvar LoginModal = function LoginModal(_ref) {\n  var active = _ref.active,\n      hide = _ref.hide;\n\n  var _useState = useState(null),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      testId = _useState2[0],\n      setTestId = _useState2[1];\n\n  var _useAuth = useAuth(),\n      refreshAuthContext = _useAuth.refreshAuthContext;\n\n  var authenticateUser = function authenticateUser() {\n    setLoading(\"Authenticating\");\n    firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider()).then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(result) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (result.user) {\n                  result.user.getIdToken().then(function (idToken) {\n                    backendLogin(idToken, result.user).then(function (response) {\n                      return refreshAuthContext();\n                    });\n                  });\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  };\n\n  var authenticateTestUser = function authenticateTestUser() {\n    setLoading(\"Authenticating Test User\");\n    testLogin().then(function (response) {\n      return refreshAuthContext();\n    });\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    children: !loading ? /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsxs(\"button\", {\n        \"data-testid\": \"login-with-google\",\n        onClick: function onClick() {\n          return authenticateUser();\n        },\n        className: \"button-google\",\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          className: \"button-icon\",\n          children: /*#__PURE__*/_jsx(GoogleSVG, {\n            size: \"30px\"\n          })\n        }), \"Sign in with Google\"]\n      }), process.env.NEXT_PUBLIC_TEST_LOGIN == \"true\" && /*#__PURE__*/_jsxs(\"div\", {\n        className: \"test-login-container\",\n        children: [/*#__PURE__*/_jsx(\"input\", {\n          \"data-testid\": \"test-login-user\",\n          value: testId,\n          onChange: function onChange(e) {\n            return setTestId(e.target.value);\n          }\n        }), /*#__PURE__*/_jsx(\"button\", {\n          \"data-testid\": \"test-login-submit\",\n          onClick: function onClick() {\n            return testLogin(testId).then(function (resp) {\n              refreshAuthContext();\n            })[\"catch\"](function (error) {\n              setLoading(\"Authentication Failed\");\n            });\n          },\n          children: \"Test Login\"\n        })]\n      })]\n    }) : /*#__PURE__*/_jsx(\"div\", {\n      children: loading\n    })\n  });\n};\n\nexport default LoginModal;","map":null,"metadata":{},"sourceType":"module"}