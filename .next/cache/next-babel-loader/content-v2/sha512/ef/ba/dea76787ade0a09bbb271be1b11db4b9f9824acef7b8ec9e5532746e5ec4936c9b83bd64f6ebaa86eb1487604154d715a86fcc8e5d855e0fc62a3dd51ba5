{"ast":null,"code":"import _regeneratorRuntime from \"/home/ajay/web/projects/dm-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/ajay/web/projects/dm-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport axios from \"axios\";\nimport firebase from \"config/firebase.config\";\nexport var backendLogin = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(idToken, user) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", axios({\n              url: process.env.NEXT_PUBLIC_MIDDLEWARE_URL + \"/session/login\",\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + idToken\n              },\n              data: {\n                provider: \"GOOGLE\"\n              },\n              withCredentials: true\n            }).then(function (res) {\n              return Promise.resolve({\n                success: true,\n                user: user\n              });\n            })[\"catch\"](function (error) {\n              return Promise.reject(error);\n            }));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function backendLogin(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var testLogin = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(testId) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", axios({\n              url: process.env.NEXT_PUBLIC_MIDDLEWARE_URL + \"/test/login/\".concat(testId),\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\"\n              }\n            }).then(function (res) {\n              return firebase.auth().signInWithCustomToken(res.data).then( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(resp) {\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.next = 2;\n                          return resp.user.getIdToken().then(function (idToken) {\n                            return Promise.resolve(backendLogin(idToken));\n                          });\n\n                        case 2:\n                          return _context2.abrupt(\"return\", _context2.sent);\n\n                        case 3:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2);\n                }));\n\n                return function (_x4) {\n                  return _ref3.apply(this, arguments);\n                };\n              }())[\"catch\"](function (error) {\n                return Promise.reject(false);\n              });\n            })[\"catch\"](function (error) {\n              return Promise.reject(false);\n            }));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function testLogin(_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}